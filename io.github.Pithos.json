{
  "app-id": "io.github.Pithos",
  "runtime": "org.gnome.Platform",
  "runtime-version": "3.22",
  "sdk": "org.gnome.Sdk",
  "command": "pithos-wrapper",
  "finish-args": [
    "--share=ipc",
    "--share=network",
    "--socket=x11",
    "--socket=wayland",
    "--socket=pulseaudio",

    "--filesystem=/etc/ssl:ro",
    "--filesystem=/etc/pki:ro",
    "--filesystem=/etc/ca-certificates:ro",

    "--env=GST_PLUGIN_PATH_1_0=/app/lib/gstreamer-1.0",
    "--talk-name=org.gtk.vfs",
    "--talk-name=org.gtk.vfs.*",

    "--env=DCONF_USER_CONFIG_DIR=.config/dconf",
    "--filesystem=xdg-run/dconf",
    "--filesystem=~/.config/dconf:ro",
    "--talk-name=ca.desrt.dconf",
    "--talk-name=org.freedesktop.secrets",

    "--talk-name=org.freedesktop.Notifications",

    "--talk-name=org.gnome.SettingsDaemon",
    "--talk-name=org.mate.SettingsDaemon",

    "--talk-name=org.gnome.ScreenSaver",
    "--talk-name=org.cinnamon.ScreenSaver",
    "--talk-name=org.freedesktop.ScreenSaver",
    "--talk-name=com.canonical.Unity.Session",

    "--own-name=org.mpris.MediaPlayer2.pithos",
    "--own-name=net.kevinmehall.Pithos",
    "--filesystem=/tmp"
  ],
  "modules": [
    {
      "name": "gstreamer-plugins-ugly",
      "config-opts": [
        "--disable-gtk-doc", "--disable-examples", "--with-plugins=mpg123"
      ],
      "cleanup": [ "/share" ],
      "build-options" : {
        "arch" : {
          "i386" : { "config-opts" : [ "--build=i586-unknown-linux-gnu" ] },
          "arm" : { "config-opts" : [ "--build=arm-unknown-linux-gnueabi" ] }
        }
      },
      "sources": [{
        "type": "archive",
        "url": "https://gstreamer.freedesktop.org/src/gst-plugins-ugly/gst-plugins-ugly-1.8.3.tar.xz",
        "sha256": "6fa2599fdd072d31fbaf50c34af406e2be944a010b1f4eab67a5fe32a0310693"
      }],
      "modules": [
        {
          "name": "mpg123",
          "cleanup": [ "/bin", "/include", "/lib/pkgconfig", "/share" ],
          "sources": [{
            "type": "archive",
            "url": "http://downloads.sourceforge.net/project/mpg123/mpg123/1.23.8/mpg123-1.23.8.tar.bz2",
            "sha256": "de2303c8ecb65593e39815c0a2f2f2d91f708c43b85a55fdd1934c82e677cf8e"
          }]
        }
      ]
    },
    {
      "name": "gstreamer-plugins-bad",
      "config-opts": [
        "--disable-gtk-doc", "--disable-introspection", "--disable-examples",
        "--disable-bz2", "--disable-curl", "--disable-dash", "--disable-webp",
        "--disable-decklink", "--disable-dtls", "--disable-dvb", "--disable-fbdev",
        "--disable-gl", "--disable-gtk3", "--disable-hls", "--disable-rsvg",
        "--disable-sndfile", "--disable-shm", "--disable-smoothstreaming",
        "--disable-vcd", "--disable-vdpau", "--disable-wayland", "--with-plugins=faad"
      ],
      "build-options" : {
        "arch" : {
          "i386" : { "config-opts" : [ "--build=i586-unknown-linux-gnu" ] },
          "arm" : { "config-opts" : [ "--build=arm-unknown-linux-gnueabi" ] }
        }
      },
      "cleanup": [
        "/include", "/share", "/lib/pkgconfig", "/lib/gstreamer-1.0/include", "/lib/libgst*"
      ],
      "sources": [{
        "type": "archive",
        "url": "https://gstreamer.freedesktop.org/src/gst-plugins-bad/gst-plugins-bad-1.8.3.tar.xz",
        "sha256": "7899fcb18e6a1af2888b19c90213af018a57d741c6e72ec56b133bc73ec8509b"
      }],
      "modules": [{
        "name": "faad",
        "cleanup": [ "/bin", "/include", "/share" ],
        "config-opts": [ "--disable-static" ],
        "no-autogen": true,
        "sources": [
          {
            "type": "archive",
            "url": "http://downloads.sourceforge.net/sourceforge/faac/faad2-2.7.tar.bz2",
            "sha256": "14561b5d6bc457e825bfd3921ae50a6648f377a9396eaf16d4b057b39a3f63b5"
          },
          {
            "type": "patch",
            "path": "libmp4ff-shared-lib.patch",
            "sha256": "e0aaefeb20ebfec2f09e88a190f78e5744d9f1c71fe41977db8e4f29b5b88022"
          },
          {
            "type": "shell",
            "commands": [ "autoreconf --force --install" ]
          }
        ]}
      ]
    },
    {
      "name": "pithos",
      "sources": [{
        "type": "git",
        "url": "https://github.com/pithos/pithos.git"
      }]
    },
    {
      "name": "wrapper",
      "no-autogen": true,
      "sources": [
        {
          "type": "file",
          "path": "ssl-wrapper",
          "dest-filename": "pithos-wrapper"
        },
        {
          "type": "file",
          "path": "wrapper-makefile",
          "dest-filename": "Makefile"
        }
      ]
    }
  ]
}
